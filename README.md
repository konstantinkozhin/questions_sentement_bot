## Зависимости

- Docker
- NVIDIA GPU с установленными драйверами и поддержкой CUDA

## Использование

1. Сначала установите Docker и драйверы NVIDIA GPU на вашем компьютере. 
Для этого проекта используется контейнер с версией CUDA 12.4.1.

2. Склонируйте репозиторий:

```bash
git clone https://github.com/sherstpasha/questions_sentement_bot
cd multi-task-bert
```

3. Соберите Docker контейнер:

```bash
docker build -t multi_task_bert .
```

4. Запустите контейнер с графическим процессором (при необходимости монтируйте папку с данными):

```bash
docker run --gpus all -it -v /путь/к/вашей/папке:/app/mounted_folder multi_task_bert
```

5. Теперь, когда вы находитесь в контейнере, вы можете запустить `train.py` с помощью следующей команды, чтобы начать обучение модели:

```bash
python3.10 train.py --epoch=100 --lr_start=5e-5 --train_data_path="mounted_folder/train_file.csv"
```

6. После окончания обучения в докере сохраняется модель с названием "best_model.pth". Чтобы перенести ее на вашу систему, выполните следующую команду `docker cp`, указав путь к файлу `best_model.pth` в контейнере и путь на вашей системе, куда вы хотите скопировать файл.

Вот пример:

```bash
docker cp <container_id>:/app/best_model.pth .
```

Где `<container_id>` - это идентификатор вашего контейнера, а `/путь/на/вашей/системе/` - путь к папке на вашей системе, куда вы хотите скопировать файл `best_model.pth`.

## Важно

Убедитесь, что ваши обучающие данные доступны в папке `/app` внутри контейнера перед запуском `train.py`.

---

### Описание файла CSV для обучения

Файл CSV с набором данных должен содержать следующие столбцы:

1. **is_relevant**: Бинарное значение (0 или 1), указывающее, является ли текст релевантным для какого-либо заданного критерия или вопроса.

2. **object**: Бинарное значение (0 или 1), определяющее объект или категорию, к которой относится текст (например, 1 может указывать на наличие объекта, а 0 - на его отсутствие).

3. **is_positive**: Бинарное значение (0 или 1), обозначающее, является ли текст положительным или отрицательным по отношению к какому-либо аспекту или контексту.

4. **text**: Строковое значение, содержащее текстовые данные или вопросы, требующие анализа или классификации. Все вопросы собраны в один абзац.

Пример:

| is_relevant | object | is_positive | text                                                  |
|-------------|--------|-------------|-------------------------------------------------------|
| 1           | 0      | 1           | Что вам больше всего понравилось в теме вебинара? Какие вопросы остались без ответа после вебинара? Какой формат вебинара вам было бы интересно видеть? Есть ли у вас предложения по улучшению вебинара? Какие темы вам было бы интересно увидеть в следующем вебинаре? |
